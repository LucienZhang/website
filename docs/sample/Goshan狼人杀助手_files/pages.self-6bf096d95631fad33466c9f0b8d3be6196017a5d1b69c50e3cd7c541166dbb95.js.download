(function() {
  $(document).on('turbolinks:load', function(e) {
    $('#js-reset').click(function(e) {
      e.preventDefault();
      return App.admin["do"]('reset');
    });
    $('#js-deal').click(function(e) {
      e.preventDefault();
      return App.admin["do"]('deal');
    });
    $('#js-start').click(function(e) {
      e.preventDefault();
      if (Wolf.status.turn === 'deal' || Wolf.status.turn === 'testament') {
        App.admin["do"]('night');
        return ion.sound.play('mute');
      } else {
        return BootstrapDialog.alert("只有查看身份阶段或者遗言阶段才能够进入夜晚");
      }
    });
    $('#js-night-info').click(function(e) {
      e.preventDefault();
      if (Wolf.status.turn === 'discuss') {
        return App.admin["do"]('night_info');
      } else {
        return BootstrapDialog.alert("只有白天才能查看信息");
      }
    });
    $('#js-start-vote').click(function(e) {
      var checkbox, i, j, len, len1, ref, ref1, target_pos, vote_desc, voter_pos;
      e.preventDefault();
      if (Wolf.status.turn === 'discuss') {
        vote_desc = $('#start-vote-modal #vote_desc').val();
        target_pos = [];
        ref = $('#start-vote-modal #target_pos .btn.active input[type=checkbox]');
        for (i = 0, len = ref.length; i < len; i++) {
          checkbox = ref[i];
          target_pos.push($(checkbox).attr('id'));
        }
        voter_pos = [];
        ref1 = $('#start-vote-modal #voter_pos .btn.active input[type=checkbox]');
        for (j = 0, len1 = ref1.length; j < len1; j++) {
          checkbox = ref1[j];
          voter_pos.push($(checkbox).attr('id'));
        }
        App.admin["do"]('start_vote', {
          desc: vote_desc,
          target_pos: target_pos,
          voter_pos: voter_pos
        });
        return $('#start-vote-modal .btn-group .btn.active').removeClass('active');
      } else {
        return BootstrapDialog.alert("只有白天讨论阶段才能发起投票");
      }
    });
    $('#js-stop-vote').click(function(e) {
      e.preventDefault();
      if (Wolf.status.turn === 'discuss') {
        return App.admin["do"]('stop_vote');
      } else {
        return BootstrapDialog.alert("只有白天讨论阶段才能终止投票");
      }
    });
    $('#js-throw').click(function(e) {
      var pos;
      e.preventDefault();
      if (Wolf.status.turn === 'discuss') {
        pos = $('#throw-modal .btn-group .btn.active input[type=radio]').val();
        return App.admin["do"]('throw', {
          pos: pos
        });
      } else {
        return BootstrapDialog.alert("只有白天讨论阶段才能放逐玩家");
      }
    });
    $('#js-wolf-win, #js-wolf-lose').click(function(e) {
      var name;
      e.preventDefault();
      name = $(e.currentTarget).attr('id');
      if (name === "js-wolf-win") {
        return App.admin["do"]('stop_game', {
          win: 'wolf'
        });
      } else if (name === "js-wolf-lose") {
        return App.admin["do"]('stop_game', {
          win: 'villager'
        });
      }
    });
    $('#js-deal-type-nav li a').click(function(e) {
      var deal_type;
      deal_type = $(e.currentTarget).attr('deal_type');
      return App.admin["do"]('deal_type', {
        deal_type: deal_type
      });
    });
    $('#js-add-coin-all-players').click(function(e) {
      var coin;
      e.preventDefault();
      coin = parseInt($('#coin-to-patch').val(), 10) || 0;
      return App.admin["do"]('add_coin_all_players', {
        coin: coin
      });
    });
    return $('#js-reset-coin-all-players').click(function(e) {
      e.preventDefault();
      return App.admin["do"]('add_coin_all_players', {
        coin: -1
      });
    });
  });

}).call(this);
